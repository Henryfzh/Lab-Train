# Lab-Train

# Usage
```
cd nanoGPT

python lightning_train.py
```

![image](nanoGPT/simple_profiler.png "Title")

```
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                               |  Mean duration (s)    |  Num calls            |  Total time (s)       |  Percentage %         |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                |  -                    |  11678                |  4.672                |  100 %                |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                   |  0.089                |  10                   |  0.89                 |  19.05                |
|  run_training_batch                                                                                                                                                   |  0.0021906            |  320                  |  0.701                |  15.004               |
|  [LightningModule]CoinFlipModel.optimizer_step                                                                                                                        |  0.0021406            |  320                  |  0.685                |  14.662               |
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                         |  0.00068438           |  320                  |  0.219                |  4.6875               |
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                              |  0.00062813           |  320                  |  0.201                |  4.3022               |
|  [LightningModule]CoinFlipModel.optimizer_zero_grad                                                                                                                   |  0.00058438           |  320                  |  0.187                |  4.0026               |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end             |  0.0126               |  10                   |  0.126                |  2.6969               |
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                           |  0.00024688           |  320                  |  0.079                |  1.6909               |
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                         |  0.00024375           |  320                  |  0.078                |  1.6695               |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end             |  5e-05                |  320                  |  0.016                |  0.34247              |
|  [LightningModule]CoinFlipModel.configure_callbacks                                                                                                                   |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.setup                                                                                                                                      |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.setup                                                                                                                                         |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                          |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.setup                                                                                                                                 |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.configure_optimizers                                                                                                                  |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                               |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_fit_start                                                                                                                                  |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start                   |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_fit_start                                                                                                                          |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                             |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_train_start                                                                                                                                |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start                 |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_train_start                                                                                                                        |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                        |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                       |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                          |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start           |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_train_epoch_start                                                                                                                  |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_before_batch_transfer                                                                                                              |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.transfer_batch_to_device                                                                                                              |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_after_batch_transfer                                                                                                               |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                       |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                       |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                          |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start           |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_train_batch_start                                                                                                                  |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                  |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                        |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                           |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad            |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_before_zero_grad                                                                                                                   |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                         |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_before_backward                                                                                                                            |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward             |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_before_backward                                                                                                                    |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                          |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_after_backward                                                                                                                             |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward              |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_after_backward                                                                                                                     |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                   |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                      |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step       |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_before_optimizer_step                                                                                                              |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.configure_gradient_clipping                                                                                                           |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                            |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_train_batch_end                                                                                                                    |  0.0                  |  320                  |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                         |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                            |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_train_epoch_end                                                                                                                    |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                         |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                            |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint             |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_save_checkpoint                                                                                                                    |  0.0                  |  10                   |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                               |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_train_end                                                                                                                                  |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end                   |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_train_end                                                                                                                          |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                          |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                 |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.on_fit_end                                                                                                                                    |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end                     |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.on_fit_end                                                                                                                            |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]TQDMProgressBar.teardown                                                                                                                                   |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelSummary.teardown                                                                                                                                      |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                       |  0.0                  |  1                    |  0.0                  |  0.0                  |
|  [LightningModule]CoinFlipModel.teardown                                                                                                                              |  0.0                  |  1                    |  0.0                  |  0.0                  |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
```
